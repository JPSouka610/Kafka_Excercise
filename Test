from kafka import KafkaProducer
from json import dumps

def create_producer(bootstrap_servers="localhost:9092"):
    """
    Crea un productor Kafka para enviar mensajes a un tópico.

    Args:
        bootstrap_servers (str): Dirección del servidor Kafka.

    Returns:
        KafkaProducer: Productor configurado.
    """
    try:
        # Crear el productor Kafka
        producer = KafkaProducer(
            bootstrap_servers=bootstrap_servers,  # Dirección del broker Kafka
            value_serializer=lambda v: dumps(v).encode('utf-8')  # Serializar mensajes a JSON
        )
        print(f"Conexión exitosa al servidor Kafka: {bootstrap_servers}")
        return producer

    except Exception as e:
        print(f"Error al crear el productor Kafka: {e}")
        return None

# Prueba de la función
producer = create_producer()

if producer:
    print("El productor Kafka está listo para enviar mensajes.")
else:
    print("Hubo un problema al conectar con Kafka.")

