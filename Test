def clean_market_data(data):
    
    try:
        df = pd.DataFrame([data])

        # Verificar que las columnas necesarias están presentes
        required_columns = ["symbol", "open", "high", "low", "close", "volume", "timestamp"]
        for col in required_columns:
            if col not in df.columns:
                raise ValueError(f"Falta la columna requerida: {col}")

        # Convertir timestamp a formato legible
        df["timestamp"] = pd.to_datetime(df["timestamp"], unit="s")

        # Validar que los valores numéricos no sean nulos o negativos
        numeric_columns = ["open", "high", "low", "close", "volume"]
        for col in numeric_columns:
            if (df[col] <= 0).any():
                raise ValueError(f"Los valores de '{col}' no pueden ser negativos o cero.")

        return df

    except Exception as e:
        print(f"Error al limpiar los datos: {e}")
        return None
